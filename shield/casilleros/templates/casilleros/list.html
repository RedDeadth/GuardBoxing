{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Casilleros</title>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Función para obtener los casilleros desde la API
            function fetchCasilleros() {
                fetch('/casilleros/api/casilleros/')
                    .then(response => response.json())
                    .then(data => {
                        const listElement = document.getElementById('casilleros-list');
                        listElement.innerHTML = '';  // Limpiar el contenido actual

                        // Iterar sobre los casilleros y mostrarlos en la lista
                        data.forEach(casillero => {
                            const listItem = document.createElement('li');
                            listItem.innerHTML = `
                                <a href="/casilleros/detalle/${casillero.id}/">${casillero.nombre}</a>
                                - ${casillero.ubicacion}
                                - ${casillero.precio}
                                <a href="/casilleros/bloquear/${casillero.id}/">${casillero.estado === 'bloqueado' ? 'Desbloquear' : 'Bloquear'}</a>
                                <a href="/casilleros/cambiar-apertura/${casillero.id}/">${casillero.apertura === 'cerrado' ? 'Abrir' : 'Cerrar'}</a>
                            `;
                            listElement.appendChild(listItem);
                        });
                    })
                    .catch(error => console.error('Error al cargar los casilleros:', error));
            }

            // Llamar a la función para cargar los casilleros cuando se cargue la página
            fetchCasilleros();
        });
    </script>
</head>
<body>
    <h1>Lista de Casilleros</h1>
    <ul id="casilleros-list"></ul>  <!-- La lista de casilleros se mostrará aquí -->
</body>
</html>
